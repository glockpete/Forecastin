# Digital Ocean Production Environment Variables
# These are configured in the Digital Ocean App Platform console or via app.yaml

# =============================================================================
# API SERVICE ENVIRONMENT VARIABLES
# =============================================================================

# Application Configuration
ENVIRONMENT=production
API_PORT=9000
LOG_LEVEL=INFO

# Database Configuration (Auto-populated by Digital Ocean Managed Database)
# These variables are automatically injected when you connect a managed database
DATABASE_HOST=${db.HOSTNAME}
DATABASE_PORT=${db.PORT}
DATABASE_NAME=${db.DATABASE}
DATABASE_USER=${db.USERNAME}
DATABASE_PASSWORD=${db.PASSWORD}
DATABASE_URL=${db.DATABASE_URL}

# Redis Configuration (Auto-populated by Digital Ocean Managed Redis)
REDIS_HOST=${redis.HOSTNAME}
REDIS_PORT=${redis.PORT}
REDIS_URL=${redis.DATABASE_URL}

# Optional: Database Connection Pool Settings
# DATABASE_POOL_MIN_SIZE=5
# DATABASE_POOL_MAX_SIZE=20

# Optional: Redis Connection Settings
# REDIS_MAX_CONNECTIONS=50

# Optional: Feature Flags
# FEATURE_FLAG_CACHE_TTL=300

# =============================================================================
# FRONTEND SERVICE ENVIRONMENT VARIABLES (Build-time)
# =============================================================================

# Node Environment
NODE_ENV=production

# API URLs (Auto-populated by Digital Ocean with the API service URL)
REACT_APP_API_URL=${api.PUBLIC_URL}
REACT_APP_WS_URL=${api.PUBLIC_URL}

# =============================================================================
# NOTES FOR DIGITAL OCEAN DEPLOYMENT
# =============================================================================

# 1. Database URLs
#    Digital Ocean automatically populates ${db.DATABASE_URL} when you
#    connect a managed PostgreSQL database to your app.
#
#    Format: postgresql://username:password@hostname:port/database
#
#    Components are also available individually:
#    - ${db.HOSTNAME}
#    - ${db.PORT}
#    - ${db.DATABASE}
#    - ${db.USERNAME}
#    - ${db.PASSWORD}

# 2. Redis URLs
#    Same as database, ${redis.DATABASE_URL} is auto-populated
#
#    Format: redis://hostname:port
#
#    Components:
#    - ${redis.HOSTNAME}
#    - ${redis.PORT}

# 3. Service URLs
#    ${api.PUBLIC_URL} - The public URL of your API service
#    ${frontend.PUBLIC_URL} - The public URL of your frontend service

# 4. Adding Environment Variables
#
#    Via App Spec (app.yaml):
#    ```yaml
#    envs:
#      - key: MY_VARIABLE
#        value: my_value
#      - key: SECRET_KEY
#        value: ${SECRET_KEY}  # References a secret
#        type: SECRET
#    ```
#
#    Via Digital Ocean Console:
#    - Go to your App → Settings → App-Level Environment Variables
#    - Or component-specific: Component → Settings → Environment Variables

# 5. Secrets
#    For sensitive data (API keys, tokens, etc.):
#    - Use Digital Ocean App Platform secrets
#    - Never commit actual secrets to git
#    - Set type: SECRET in app.yaml
#
#    Example:
#    ```yaml
#    envs:
#      - key: API_SECRET_KEY
#        value: ${API_SECRET_KEY}
#        type: SECRET
#    ```

# 6. Build vs Runtime Variables
#    - Frontend (React) variables must be prefixed with REACT_APP_
#    - Frontend variables are baked into the build (build-time)
#    - API variables are available at runtime
#    - Changes to frontend env vars require a rebuild

# =============================================================================
# PRODUCTION CHECKLIST
# =============================================================================

# Before deploying to production:
# [ ] Set production: true in app.yaml for databases
# [ ] Use appropriate instance sizes (not basic-xs for production)
# [ ] Enable database backups
# [ ] Set up custom domain and SSL
# [ ] Configure monitoring and alerts
# [ ] Review and set all required environment variables
# [ ] Test health check endpoints
# [ ] Enable auto-scaling if needed
# [ ] Set up logging and monitoring
# [ ] Review security settings
# [ ] Configure CORS properly
# [ ] Set up rate limiting if needed

# =============================================================================
# COMMON ENVIRONMENT VARIABLE PATTERNS
# =============================================================================

# If you need to add API keys or external service credentials:
# OPENAI_API_KEY=your-key-here
# STRIPE_SECRET_KEY=your-key-here
# SENDGRID_API_KEY=your-key-here
# AWS_ACCESS_KEY_ID=your-key-here
# AWS_SECRET_ACCESS_KEY=your-key-here

# If you need to configure additional services:
# SENTRY_DSN=your-sentry-dsn
# CLOUDINARY_URL=your-cloudinary-url
# S3_BUCKET_NAME=your-bucket-name
# CDN_URL=your-cdn-url

# If you need authentication/security settings:
# JWT_SECRET_KEY=your-jwt-secret
# CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
# SESSION_SECRET=your-session-secret

# =============================================================================
# HOW TO SET THESE IN DIGITAL OCEAN
# =============================================================================

# Method 1: Using the App Spec file (.do/app.yaml)
# Add to the envs section of your service:
#
# services:
#   - name: api
#     envs:
#       - key: YOUR_VARIABLE
#         value: your_value

# Method 2: Using the Digital Ocean Console
# 1. Go to: Apps → Your App → Settings
# 2. Click "App-Level Environment Variables" or component-specific settings
# 3. Click "Edit" and add your variables
# 4. Save and redeploy

# Method 3: Using doctl CLI
# doctl apps update YOUR_APP_ID --spec .do/app.yaml

# =============================================================================
# TROUBLESHOOTING
# =============================================================================

# If environment variables aren't working:
# 1. Check they're set in the correct component (api vs frontend)
# 2. For frontend, ensure REACT_APP_ prefix
# 3. For database variables, ensure database is connected
# 4. Redeploy after changing environment variables
# 5. Check logs: doctl apps logs YOUR_APP_ID --type RUN
